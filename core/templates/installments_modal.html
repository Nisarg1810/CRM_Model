<!-- Installments Modal -->
<div class="modal fade" id="installmentsModal" tabindex="-1" aria-labelledby="installmentsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="installmentsModalLabel">
          <i class="bi bi-cash-coin me-2"></i>Installments
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="installments-content">
          <!-- Header with Add Button -->
          <div class="installments-header d-flex justify-content-between align-items-center mb-4">
            <h6 class="mb-0">Installment Details</h6>
            <button type="button" class="btn btn-success btn-sm" onclick="addInstallmentRow()">
              <i class="bi bi-plus-circle me-1"></i>Add Installment
            </button>
          </div>
          
          <!-- Installment Rows Container -->
          <div id="installmentRowsContainer">
            <!-- Default rows will be added here -->
          </div>
          
          <!-- Total Summary -->
          <div class="installments-footer">
            <div class="total-summary">
              <div class="total-info">
                <i class="bi bi-check-circle me-2"></i>
                <span id="totalPercentage">Total: 0.00%</span>
                <span id="totalStatus" class="ms-2">(Incomplete)</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-success" onclick="processInstallments()">
          <i class="bi bi-check-circle me-2"></i>Process Sale
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Payment Modal -->
<div class="modal fade" id="paymentModal" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="paymentModalLabel">
          <i class="bi bi-credit-card me-2"></i>Process Payment
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="paymentForm" enctype="multipart/form-data">
          <!-- Date Field -->
          <div class="mb-3">
            <label for="paymentDate" class="form-label">Date <span class="text-danger">*</span></label>
            <input type="date" class="form-control" id="paymentDate" required>
          </div>
          
          <!-- RTGS Field -->
          <div class="mb-3">
            <label for="rtgsNumber" class="form-label">RTGS Number</label>
            <input type="text" class="form-control" id="rtgsNumber" placeholder="Enter RTGS number">
          </div>
          
          <!-- From Bank Field -->
          <div class="mb-3">
            <label for="fromBank" class="form-label">From Bank</label>
            <input type="text" class="form-control" id="fromBank" placeholder="Enter sender bank name">
          </div>
          
          <!-- UTR Reference Number Field -->
          <div class="mb-3">
            <label for="utrReference" class="form-label">UTR Reference Number</label>
            <input type="text" class="form-control" id="utrReference" placeholder="Enter UTR reference number">
          </div>
          
          <!-- IFSC Field -->
          <div class="mb-3">
            <label for="ifscCode" class="form-label">IFSC Code</label>
            <input type="text" class="form-control" id="ifscCode" placeholder="Enter IFSC code" maxlength="11">
          </div>
          
          <!-- Bank Name Field -->
          <div class="mb-3">
            <label for="bankName" class="form-label">Bank Name</label>
            <input type="text" class="form-control" id="bankName" placeholder="Enter bank name">
          </div>
          
          <!-- Cheque Photo Upload Field -->
          <div class="mb-3">
            <label for="chequePhoto" class="form-label">Cheque Photo Upload</label>
            <input type="file" class="form-control" id="chequePhoto" accept="image/*" onchange="previewChequePhoto(this)">
            <div class="form-text">Upload a clear photo of the cheque (JPG, PNG, GIF)</div>
            <div id="chequePhotoPreview" class="mt-2" style="display: none;">
              <img id="previewImage" src="" alt="Cheque Preview" class="img-thumbnail" style="max-width: 200px; max-height: 150px;">
              <button type="button" class="btn btn-sm btn-outline-danger ms-2" onclick="removeChequePhoto()">Remove</button>
            </div>
          </div>
          
          <!-- Remark Field -->
          <div class="mb-3">
            <label for="paymentRemark" class="form-label">Remark</label>
            <textarea class="form-control" id="paymentRemark" rows="3" placeholder="Enter payment processing remarks..."></textarea>
            <div class="form-text">Add any additional notes or remarks about this payment</div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-success" onclick="processPayment()">
          <i class="bi bi-check-circle me-2"></i>Process Payment
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Payment Details Modal -->
<div class="modal fade" id="paymentDetailsModal" tabindex="-1" aria-labelledby="paymentDetailsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="paymentDetailsModalLabel">
          <i class="bi bi-receipt me-2"></i>Payment Details
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="paymentDetailsModalBody">
        <!-- Payment details will be loaded here -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
